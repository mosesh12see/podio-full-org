<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Full Org Return - Complete Performance Dashboard</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 50%, #7e22ce 100%);
            min-height: 100vh;
            padding: 20px;
            color: #fff;
            font-size: 13px;
        }

        .container {
            max-width: 1800px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 25px;
        }

        .header h1 {
            font-size: 2.2em;
            margin-bottom: 8px;
            background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: 0 0 30px rgba(251, 191, 36, 0.5);
        }

        .header p {
            font-size: 1em;
            opacity: 0.9;
        }

        .last-updated {
            text-align: center;
            opacity: 0.7;
            margin-bottom: 20px;
            font-size: 0.85em;
        }

        /* Summary Cards */
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 25px;
            margin-bottom: 40px;
        }

        .summary-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 12px;
            padding: 18px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .summary-card h2 {
            font-size: 1.3em;
            margin-bottom: 12px;
            border-bottom: 2px solid rgba(251, 191, 36, 0.5);
            padding-bottom: 8px;
        }

        .metric-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }

        .metric {
            background: rgba(255, 255, 255, 0.05);
            padding: 10px;
            border-radius: 8px;
        }

        .metric-label {
            font-size: 0.8em;
            opacity: 0.8;
            margin-bottom: 5px;
        }

        .metric-value {
            font-size: 1.4em;
            font-weight: bold;
            color: #fbbf24;
        }

        .metric-value.success {
            color: #4ade80;
        }

        .metric-value.info {
            color: #60a5fa;
        }

        /* Daily Averages Section */
        .daily-avg-section {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 12px;
            padding: 18px;
            margin-bottom: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .daily-avg-section h2 {
            font-size: 1.5em;
            margin-bottom: 15px;
            text-align: center;
            color: #fbbf24;
        }

        .daily-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
        }

        .daily-box {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }

        .daily-box .label {
            font-size: 0.9em;
            opacity: 0.8;
            margin-bottom: 8px;
        }

        .daily-box .value {
            font-size: 1.8em;
            font-weight: bold;
            color: #4ade80;
        }

        /* Monthly Breakdown Table */
        .monthly-section {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 12px;
            padding: 18px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            margin-bottom: 20px;
        }

        .monthly-section h2 {
            font-size: 1.5em;
            margin-bottom: 15px;
            text-align: center;
            color: #fbbf24;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            overflow: hidden;
            font-size: 0.95em;
        }

        th {
            background: rgba(251, 191, 36, 0.2);
            padding: 10px 12px;
            text-align: left;
            font-weight: 600;
            border-bottom: 2px solid rgba(251, 191, 36, 0.5);
        }

        td {
            padding: 8px 12px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        tr:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        .footer {
            text-align: center;
            margin-top: 40px;
            opacity: 0.6;
            font-size: 0.95em;
        }

        .footer p {
            margin: 5px 0;
        }

        /* Auto-refresh indicator */
        .refresh-indicator {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 10px 15px;
            border-radius: 8px;
            font-size: 0.9em;
            z-index: 1000;
            backdrop-filter: blur(10px);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üìä FULL ORG RETURN</h1>
            <p>Comprehensive Performance Dashboard - Real Podio Data</p>
        </div>

        <div class="last-updated">
            Last Updated: November 16, 2025 at 09:01 PM<br>
            <span style="font-size: 0.75em; opacity: 0.7; font-style: italic;">cron job: 9am, 12pm, 3pm, 6pm, 9pm daily | last ran: november 16, 2025 at 09:01 pm</span>
        </div>

        <!-- Summary Cards: YTD 2025, MTD, WTD -->
        <div class="summary-grid">
            <!-- YTD 2025 Card -->
            <div class="summary-card">
                <h2>üìÜ YTD 2025 (Year to Date)</h2>
                <p style="opacity: 0.7; margin-bottom: 15px; font-size: 0.9em;">Jan 1, 2025 to 2025-11-16</p>
                <div class="metric-grid">
                    <div class="metric">
                        <div class="metric-label">Total Appointments</div>
                        <div class="metric-value info">586</div>
                    </div>
                    <div class="metric">
                        <div class="metric-label">Sits</div>
                        <div class="metric-value info">375</div>
                    </div>
                    <div class="metric">
                        <div class="metric-label">Sit Rate</div>
                        <div class="metric-value success">64.0%</div>
                    </div>
                    <div class="metric">
                        <div class="metric-label">Closed Deals</div>
                        <div class="metric-value success">94</div>
                    </div>
                    <div class="metric">
                        <div class="metric-label">Close Rate</div>
                        <div class="metric-value success">25.1%</div>
                    </div>
                    <div class="metric">
                        <div class="metric-label">KW Closed</div>
                        <div class="metric-value">910.13</div>
                    </div>
                    <div class="metric">
                        <div class="metric-label">Revenue</div>
                        <div class="metric-value">$5,005,742</div>
                    </div>
                    <div class="metric" style="grid-column: span 2;">
                        <div class="metric-label">States</div>
                        <div class="metric-value" style="font-size: 0.9em; line-height: 1.5;">IL (281), MO (193), MI (42), OH (21), KS (20), GA (18), KY (5), Unknown (4), CO (1), TX (1)</div>
                    </div>
                </div>
            </div>

            <!-- MTD Card -->
            <div class="summary-card">
                <h2>üìÖ MTD (Month to Date)</h2>
                <p style="opacity: 0.7; margin-bottom: 15px; font-size: 0.9em;">2025-11-01 to 2025-11-16</p>
                <div class="metric-grid">
                    <div class="metric">
                        <div class="metric-label">Total Appointments</div>
                        <div class="metric-value info">37</div>
                    </div>
                    <div class="metric">
                        <div class="metric-label">Sits</div>
                        <div class="metric-value info">26</div>
                    </div>
                    <div class="metric">
                        <div class="metric-label">Sit Rate</div>
                        <div class="metric-value success">70.3%</div>
                    </div>
                    <div class="metric">
                        <div class="metric-label">Closed Deals</div>
                        <div class="metric-value success">7</div>
                    </div>
                    <div class="metric">
                        <div class="metric-label">Close Rate</div>
                        <div class="metric-value success">26.9%</div>
                    </div>
                    <div class="metric">
                        <div class="metric-label">KW Closed</div>
                        <div class="metric-value">91.23</div>
                    </div>
                    <div class="metric">
                        <div class="metric-label">Revenue</div>
                        <div class="metric-value">$501,765</div>
                    </div>
                    <div class="metric" style="grid-column: span 2;">
                        <div class="metric-label">States</div>
                        <div class="metric-value" style="font-size: 0.9em; line-height: 1.5;">IL (21), MO (8), GA (5), Unknown (2), CO (1)</div>
                    </div>
                </div>
            </div>

            <!-- WTD Card (Week to Date) -->
            <div class="summary-card">
                <h2>üìä WTD (Week to Date)</h2>
                <p style="opacity: 0.7; margin-bottom: 15px; font-size: 0.9em;">2025-11-10 to 2025-11-16</p>
                <div class="metric-grid">
                    <div class="metric">
                        <div class="metric-label">Total Appointments</div>
                        <div class="metric-value info">10</div>
                    </div>
                    <div class="metric">
                        <div class="metric-label">Sits</div>
                        <div class="metric-value info">10</div>
                    </div>
                    <div class="metric">
                        <div class="metric-label">Sit Rate</div>
                        <div class="metric-value success">100.0%</div>
                    </div>
                    <div class="metric">
                        <div class="metric-label">Closed Deals</div>
                        <div class="metric-value success">4</div>
                    </div>
                    <div class="metric">
                        <div class="metric-label">Close Rate</div>
                        <div class="metric-value success">40.0%</div>
                    </div>
                    <div class="metric">
                        <div class="metric-label">KW Closed</div>
                        <div class="metric-value">47.07</div>
                    </div>
                    <div class="metric">
                        <div class="metric-label">Revenue</div>
                        <div class="metric-value">$258,885</div>
                    </div>
                    <div class="metric" style="grid-column: span 2;">
                        <div class="metric-label">States</div>
                        <div class="metric-value" style="font-size: 0.9em; line-height: 1.5;">IL (7), MO (3)</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Monthly Breakdown Table -->
        <div class="monthly-section">
            <h2>üìä Per-Month Breakdown</h2>
            <table>
                <thead>
                    <tr>
                        <th>Month</th>
                        <th>Appointments</th>
                        <th>Sits</th>
                        <th>Sit Rate</th>
                        <th>Closed</th>
                        <th>Close Rate</th>
                        <th>KW</th>
                        <th>Revenue</th>
                    </tr>
                </thead>
                <tbody>
                    
        <tr>
            <td>November 2025</td>
            <td>38</td>
            <td>26</td>
            <td>68.4%</td>
            <td>7</td>
            <td>26.9%</td>
            <td>91.23</td>
            <td>$501,765</td>
        </tr>
        
        <tr>
            <td>October 2025</td>
            <td>132</td>
            <td>77</td>
            <td>58.3%</td>
            <td>20</td>
            <td>26.0%</td>
            <td>129.88</td>
            <td>$714,340</td>
        </tr>
        
        <tr>
            <td>September 2025</td>
            <td>129</td>
            <td>84</td>
            <td>65.1%</td>
            <td>18</td>
            <td>21.4%</td>
            <td>223.47</td>
            <td>$1,229,058</td>
        </tr>
        
        <tr>
            <td>August 2025</td>
            <td>279</td>
            <td>179</td>
            <td>64.2%</td>
            <td>48</td>
            <td>26.8%</td>
            <td>465.56</td>
            <td>$2,560,580</td>
        </tr>
        
                </tbody>
            </table>
        </div>

        <!-- Daily Averages -->
        <div class="daily-avg-section">
            <h2>üìà Daily Averages</h2>

            <!-- YTD Daily Averages -->
            <div style="margin-bottom: 30px;">
                <h3 style="font-size: 1.5em; margin-bottom: 20px; text-align: center; color: #60a5fa;">
                    üìÜ YTD Daily Averages (93 active days)
                </h3>
                <div class="daily-grid">
                    <div class="daily-box">
                        <div class="label">Avg Appointments per Day</div>
                        <div class="value">6.3</div>
                    </div>
                    <div class="daily-box">
                        <div class="label">Avg Sits per Day</div>
                        <div class="value">4.03</div>
                    </div>
                    <div class="daily-box">
                        <div class="label">Avg Closed per Day</div>
                        <div class="value">1.01</div>
                    </div>
                </div>
            </div>

            <!-- MTD Daily Averages -->
            <div style="margin-bottom: 30px;">
                <h3 style="font-size: 1.5em; margin-bottom: 20px; text-align: center; color: #4ade80;">
                    üìÖ MTD Daily Averages (13 active days)
                </h3>
                <div class="daily-grid">
                    <div class="daily-box">
                        <div class="label">Avg Appointments per Day</div>
                        <div class="value">2.85</div>
                    </div>
                    <div class="daily-box">
                        <div class="label">Avg Sits per Day</div>
                        <div class="value">2.0</div>
                    </div>
                    <div class="daily-box">
                        <div class="label">Avg Closed per Day</div>
                        <div class="value">0.54</div>
                    </div>
                </div>
            </div>

            <!-- WTD Daily Averages -->
            <div>
                <h3 style="font-size: 1.5em; margin-bottom: 20px; text-align: center; color: #fbbf24;">
                    üìä WTD Daily Averages (6 active days)
                </h3>
                <div class="daily-grid">
                    <div class="daily-box">
                        <div class="label">Avg Appointments per Day</div>
                        <div class="value">1.67</div>
                    </div>
                    <div class="daily-box">
                        <div class="label">Avg Sits per Day</div>
                        <div class="value">1.67</div>
                    </div>
                    <div class="daily-box">
                        <div class="label">Avg Closed per Day</div>
                        <div class="value">0.67</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Dashboard Info -->
        <div class="daily-avg-section">
            <h2>‚ÑπÔ∏è Dashboard Info</h2>
            <p style="opacity: 0.8; margin-bottom: 15px; text-align: center;">Real-time data from Podio for the Full Organization</p>

            <div style="background: rgba(255,255,255,0.05); padding: 15px; border-radius: 10px; margin-bottom: 15px;">
                <p style="font-weight: bold; margin-bottom: 8px;">Time Periods:</p>
                <p style="font-size: 0.9em; margin: 5px 0;">
                    <strong style="color: #60a5fa;">YTD 2025:</strong> Jan 1, 2025 to today
                </p>
                <p style="font-size: 0.9em; margin: 5px 0;">
                    <strong style="color: #4ade80;">MTD:</strong> This month only
                </p>
                <p style="font-size: 0.9em; margin: 5px 0;">
                    <strong style="color: #fbbf24;">WTD:</strong> This week only
                </p>
            </div>

            <p style="opacity: 0.7; font-size: 0.9em;">
                <strong>Calculations:</strong><br>
                ‚Ä¢ Revenue: KW √ó 1000 √ó $5.50<br>
                ‚Ä¢ Sit Rate: Sits √∑ Appointments<br>
                ‚Ä¢ Close Rate: Closed √∑ Sits
            </p>
        </div>

        <!-- Monthly Breakdown Table -->
        <div class="monthly-section">
            <h2>üìä Per-Month Breakdown</h2>
            <table>
                <thead>
                    <tr>
                        <th>Month</th>
                        <th>Appointments</th>
                        <th>Sits</th>
                        <th>Sit Rate</th>
                        <th>Closed</th>
                        <th>Close Rate</th>
                        <th>KW</th>
                        <th>Revenue</th>
                    </tr>
                </thead>
                <tbody>
                    
        <tr>
            <td>November 2025</td>
            <td>38</td>
            <td>26</td>
            <td>68.4%</td>
            <td>7</td>
            <td>26.9%</td>
            <td>91.23</td>
            <td>$501,765</td>
        </tr>
        
        <tr>
            <td>October 2025</td>
            <td>132</td>
            <td>77</td>
            <td>58.3%</td>
            <td>20</td>
            <td>26.0%</td>
            <td>129.88</td>
            <td>$714,340</td>
        </tr>
        
        <tr>
            <td>September 2025</td>
            <td>129</td>
            <td>84</td>
            <td>65.1%</td>
            <td>18</td>
            <td>21.4%</td>
            <td>223.47</td>
            <td>$1,229,058</td>
        </tr>
        
        <tr>
            <td>August 2025</td>
            <td>279</td>
            <td>179</td>
            <td>64.2%</td>
            <td>48</td>
            <td>26.8%</td>
            <td>465.56</td>
            <td>$2,560,580</td>
        </tr>
        
                </tbody>
            </table>
        </div>

        <div class="footer">
            <p><strong>Full Organization Return Dashboard</strong> | Podio Closer App Data</p>
            <p>YTD 2025: 2025-01-01 to 2025-11-16 | MTD: 2025-11-01 to 2025-11-16 | WTD: 2025-11-10 to 2025-11-16</p>
            <p style="margin-top: 10px;">
                üí∞ Revenue Rate: $5.50/watt
            </p>
        </div>
    </div>

    <!-- Refresh Indicator -->
    <div class="refresh-indicator" id="refreshIndicator">Next refresh: Calculating...</div>

    <script>
        // ========== AUTO-REFRESH SCHEDULER ==========
        const REFRESH_TIMES = [
            { hour: 9, minute: 0 },   // 9:00 AM
            { hour: 12, minute: 0 },  // 12:00 PM
            { hour: 15, minute: 0 },  // 3:00 PM
            { hour: 18, minute: 0 },  // 6:00 PM
            { hour: 21, minute: 0 }   // 9:00 PM
        ];

        function getNextRefreshTime() {
            const now = new Date();
            const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());

            let nextRefresh = null;

            // Check today's refresh times
            for (const time of REFRESH_TIMES) {
                const refreshTime = new Date(today);
                refreshTime.setHours(time.hour, time.minute, 0, 0);

                if (refreshTime > now) {
                    nextRefresh = refreshTime;
                    break;
                }
            }

            // If no refresh time today, use first time tomorrow
            if (!nextRefresh) {
                const tomorrow = new Date(today);
                tomorrow.setDate(tomorrow.getDate() + 1);
                tomorrow.setHours(REFRESH_TIMES[0].hour, REFRESH_TIMES[0].minute, 0, 0);
                nextRefresh = tomorrow;
            }

            return nextRefresh;
        }

        function formatTime(date) {
            return date.toLocaleTimeString('en-US', {
                hour: 'numeric',
                minute: '2-digit',
                hour12: true
            });
        }

        function formatTimeUntil(ms) {
            const hours = Math.floor(ms / (1000 * 60 * 60));
            const minutes = Math.floor((ms % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((ms % (1000 * 60)) / 1000);

            if (hours > 0) {
                return `${hours}h ${minutes}m`;
            } else if (minutes > 0) {
                return `${minutes}m ${seconds}s`;
            } else {
                return `${seconds}s`;
            }
        }

        function updateRefreshIndicator() {
            const now = new Date();
            const nextRefresh = getNextRefreshTime();
            const timeUntil = nextRefresh - now;

            const indicator = document.getElementById('refreshIndicator');
            indicator.innerHTML = `Next refresh: ${formatTime(nextRefresh)}<br>Time until: ${formatTimeUntil(timeUntil)}`;

            // If it's time to refresh (within 5 seconds)
            if (timeUntil <= 5000 && timeUntil > 0) {
                indicator.innerHTML = `Refreshing in ${Math.ceil(timeUntil / 1000)}s...`;
            }

            if (timeUntil <= 0) {
                indicator.innerHTML = 'Refreshing now...';
                setTimeout(() => {
                    window.location.reload();
                }, 1000);
            }
        }

        // Update indicator every second
        setInterval(updateRefreshIndicator, 1000);
        updateRefreshIndicator();
    </script>
</body>
</html>
